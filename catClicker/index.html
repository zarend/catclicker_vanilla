<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Cat Clicker</title>
    <script type="text/javascript">
      var CatModel = (function() {
        var CatModel = function(cats) {
          this.cats = cats || [];

          for (var idx in cats) {
            this.cats[idx].count = 0;
            this.cats[idx].idx = idx;
          }

          this.currCat = this.cats[0];
        }

        CatModel.prototype.incrementCatCount = function(idx) {
          this.cats[idx].count++;
        }

        return CatModel;
      })();

      var CatController = (function() {
        var CatController = function() {}

        CatController.prototype.clickCat = function() {
          catModel.incrementCatCount(catModel.currCat.idx);
          catView.renderDisplayArea();
        }

        CatController.prototype.selectCat = function(idx) {
          catModel.currCat = catModel.cats[idx];
          catView.renderDisplayArea();
        }

        return CatController;
      })();

      var CatView = (function() {
        var CatView = function() {
          this.list = document.getElementById('list');
          this.displayArea = document.getElementById('displayArea');
          this.name = document.getElementById('name');
          this.pic = document.getElementById('pic');
          this.count = document.getElementById('count');

          pic.addEventListener('click', function() {
            catCtrl.clickCat();
          });
        }

        CatView.prototype.renderCatList = function() {
          for (var idx in catModel.cats) {
            (function (idx) {
              var nextCat = catModel.cats[idx];
              var catPicker = document.createElement('div');
              catPicker.innerHTML = nextCat.name;
              catPicker.addEventListener('click', function() {
                (function(idx) {
                  catCtrl.selectCat(idx);
                })(idx);
              });
              this.list.appendChild(catPicker);
            })(idx);
          }
        }

        CatView.prototype.renderDisplayArea = function() {
          var cat = catModel.currCat;
          this.name.innerHTML = cat.name;
          this.pic.src = 'img/' + cat.img;
          this.count.innerHTML = cat.count;
        }

        CatView.prototype.render = function() {
          this.renderCatList();
          this.renderDisplayArea();
        }

        return CatView;
      })();

      var catModel = new CatModel([
        {name: 'cat', img: 'cat.jpg'},
        {name: 'nextCat', img: 'cat2.jpg'},
        {name: 'burrito', img: 'burrito.jpg'},
        {name: 'bullet', img: 'bullet.jpg'},
        {name: 'prayer', img: 'praying.jpg'},
      ]);

      var catCtrl = new CatController();
      var catView;

      var handleLoad = function() {
        catView = new CatView();
        catView.render();
      } 
    </script>
  </head>
  <body onload="handleLoad()">
    <h1> Welcome to Cat Clicker! </h1>
    <div id="list">
    </div>
    <div id="displayArea">
      <h6 id="name"> </h6>
      <img id="pic">
      <h6> <span id="count"> </span> clicks</h6>
    </div>
  <body>
</html>
