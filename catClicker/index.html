<!DOCTYPE html>
<html>
  <head>
    <title>Cat Clicker</title>
    <script type="text/javascript">
      var cats = [
        {name: 'cat', img: 'cat.jpg'},
        {name: 'nextCat', img: 'cat2.jpg'},
        {name: 'burrito', img: 'burrito.jpg'},
        {name: 'bullet', img: 'bullet.jpg'},
        {name: 'prayer', img: 'praying.jpg'},
      ];

      var nextId = 0;
      cats.forEach(function(nextCat) {
        nextCat.id = nextId;
        nextId++;
      })

      var makeCatElement = function(cat) {
        var name = cat.name;
        var picture = cat.img;
        var id = cat.id;

        localStorageKey = 'cat' + id + '_count';
        count = parseInt(localStorage.getItem(localStorageKey));
        if (isNaN(count)) {
          count = 0;
        }

        var cat = document.createElement('div');
        var h2 = document.createElement('h2');
        h2.innerHTML = name + " ";
        var span = document.createElement('span');
        span.id = 'cat ' + id + '_numClicks';
        span.innerHTML = count;
        var img = document.createElement('img');
        img.src = picture;
        img.alt = 'picture of' + name;
        img.addEventListener('click', function() {
          count = parseInt(span.innerHTML);
          if (isNaN(count)) {
            count = 0;
          }
          count++;
          localStorage.setItem(localStorageKey, count);
          span.innerHTML = count;
        });

        cat.appendChild(img);
        cat.appendChild(h2);
        h2.appendChild(span);

        return cat;
      }

      var handleLoad = function() {
        var list = document.getElementById('list');
        var displayArea = document.getElementById('displayArea');
        var catElement = null;

        var displayCat = function(catIdx) {
          var nextCatElement = makeCatElement(cats[catIdx]);
          if (nextCatElement) {
            if (catElement) {
              displayArea.replaceChild(nextCatElement, catElement);
            } else {
              displayArea.appendChild(nextCatElement);
            }
            catElement = nextCatElement;
          }
        }

        cats.forEach(function(nextCat) {
          var catPicker = document.createElement('div');
          catPicker.innerHTML = nextCat.name;
          catPicker.addEventListener('click', function() {
            displayCat(nextCat.id);
          });
          list.appendChild(catPicker);
        });
      } 
    </script>
  </head>
  <body onload="handleLoad()">
    <h1> Welcome to Cat Clicker! </h1>
    <div id="list">
    </div>
    <div id="displayArea">
    </div>
  <body>
</html>
